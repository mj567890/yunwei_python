# IT运维系统 - 导入资产功能使用指南

## 功能概述

资产导入功能允许您通过Excel或CSV文件批量导入资产数据到IT运维系统中，支持完整的数据验证和错误处理。

## 支持的文件格式

- **Excel格式**: `.xlsx`, `.xls`
- **CSV格式**: `.csv` (UTF-8编码)

## 操作步骤

### 1. 准备导入文件

#### 方法一：下载模板
1. 在资产管理页面，点击"📥 导入资产"按钮
2. 在弹出的对话框中，点击"下载导入模板"链接
3. 使用下载的模板文件，按照格式填写资产数据

#### 方法二：自定义文件
创建包含以下字段的Excel或CSV文件：

**必填字段**：
- `资产编码` (asset_code) - 唯一标识，不能重复
- `资产名称` (name) - 资产名称

**可选字段**：
- `品牌` (brand) - 设备品牌
- `型号` (model) - 设备型号
- `类别` (category) - 资产类别
- `状态` (status) - 在用/闲置/维修/报废
- `使用人` (user_name) - 当前使用人
- `使用部门` (user_department) - 所属部门
- `保修开始日期` (warranty_start_date) - 格式：YYYY-MM-DD
- `保修结束日期` (warranty_end_date) - 格式：YYYY-MM-DD
- `保修期(月)` (warranty_period) - 数字，如36

### 2. 执行导入

1. 点击"📥 导入资产"按钮
2. 选择准备好的Excel或CSV文件
3. 点击"确认导入"
4. 等待导入完成，系统会显示导入结果

## 数据示例

### CSV格式示例
```csv
资产编码,资产名称,品牌,型号,类别,状态,使用人,使用部门
SV001,服务器01,Dell,PowerEdge R750,服务器,在用,张三,IT部
NB001,笔记本01,Lenovo,ThinkPad X1,笔记本,在用,李四,财务部
PR001,打印机01,HP,LaserJet Pro,办公设备,闲置,王五,行政部
```

### Excel格式示例
| 资产编码 | 资产名称 | 品牌   | 型号          | 类别     | 状态 | 使用人 | 使用部门 |
|----------|----------|--------|---------------|----------|------|--------|----------|
| SV001    | 服务器01 | Dell   | PowerEdge R750| 服务器   | 在用 | 张三   | IT部     |
| NB001    | 笔记本01 | Lenovo | ThinkPad X1   | 笔记本   | 在用 | 李四   | 财务部   |
| PR001    | 打印机01 | HP     | LaserJet Pro  | 办公设备 | 闲置 | 王五   | 行政部   |

## 导入结果说明

导入完成后，系统会显示：
- **成功导入条数**: 成功添加到系统的资产数量
- **失败条数**: 因错误无法导入的记录数量
- **错误详情**: 具体的错误信息（如资产编码重复、必填字段缺失等）

## 常见错误及解决方案

### 1. 资产编码已存在
**错误**: "资产编码 XXX 已存在"
**解决**: 检查资产编码是否重复，使用唯一的编码

### 2. 必填字段缺失
**错误**: "第X行: 资产编码不能为空" 或 "第X行: 资产名称不能为空"
**解决**: 确保每行都填写了资产编码和资产名称

### 3. 文件格式错误
**错误**: "只支持 Excel (.xlsx, .xls) 和 CSV (.csv) 文件格式"
**解决**: 确保文件格式正确，CSV文件使用UTF-8编码保存

### 4. 日期格式错误
**问题**: 保修日期无法正确解析
**解决**: 使用标准日期格式 YYYY-MM-DD，如 2024-01-01

## 注意事项

1. **文件大小限制**: 单个文件不超过10MB
2. **编码格式**: CSV文件请使用UTF-8编码保存
3. **数据完整性**: 导入前请仔细检查数据的准确性
4. **重复数据**: 系统会自动检测重复的资产编码并跳过
5. **备份建议**: 大批量导入前建议先备份现有数据

## API接口信息

### 导入资产 API
- **端点**: `POST /api/assets/import`
- **参数**: `file` (multipart/form-data)
- **响应**: JSON格式的导入结果

### 下载模板 API
- **端点**: `GET /api/assets/import-template`
- **响应**: Excel文件下载

## 技术支持

如果在使用过程中遇到问题，请：
1. 检查文件格式和数据完整性
2. 查看错误详情中的具体说明
3. 参考本文档的常见错误解决方案
4. 联系系统管理员获取技术支持

---

*更新时间: 2025-10-07*
*版本: v1.0*